<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>smart-npm</h1><p><a href="https://npmjs.org/package/smart-npm"><img src="https://badge.fury.io/js/smart-npm.svg" alt="NPM version"></a>
<a href="https://github.com/qiu8310/smart-npm"><img src="http://img.shields.io/github/tag/qiu8310/smart-npm.svg" alt="GitHub version"></a>
<a href="https://travis-ci.org/qiu8310/smart-npm"><img src="https://travis-ci.org/qiu8310/smart-npm.svg?branch=master" alt="Build Status"></a>
<a href="https://david-dm.org/qiu8310/smart-npm"><img src="https://david-dm.org/qiu8310/smart-npm.svg?theme=shields.io" alt="Dependency Status"></a>
<a href="http://inch-ci.org/github/qiu8310/smart-npm"><img src="http://inch-ci.org/github/qiu8310/smart-npm.svg?branch=master" alt="Inline docs"></a>
<a href="https://coveralls.io/r/qiu8310/smart-npm"><img src="https://coveralls.io/repos/qiu8310/smart-npm/badge.png" alt="Coverage Status"></a></p>
<p>智能的 <code>npm</code>，让你在中国使用 <code>npm</code> 时，下载速度更快，使用更方便！</p>
<p><a href="http://qiu8310.github.io/smart-npm">jsdoc 生成的文档</a></p>
<p><a href="https://github.com/qiu8310/smart-npm">github 地址</a></p>
<p><strong>通知：新发布的 1.0.0 版本去掉了 <code>cnpm</code> 模块，详情查看 <a href="CHANGELOG.md">Changelog</a></strong></p>
<h2>背景</h2><blockquote>
<p>用 <a href="https://npmjs.org/"><code>npm</code></a> 时，默认它会访问国外资源，所以会非常卡，有时甚至会被墙。现在市面上一般有三种解决方案：</p>
<ol>
<li><p>在 <code>.npmrc</code> 上配置一个国内的 registry 镜像</p>
</li>
<li><p>使用 <a href="https://npm.taobao.org/"><code>cnpm</code></a></p>
</li>
<li><p>使用 VPN</p>
</li>
</ol>
</blockquote>
<ul>
<li><p>第1个方案很粗暴，可以解决很多下载慢的问题，但是当你用 <code>npm publish</code> 时就会失败</p>
</li>
<li><p>第2个方案不错，但这样你就又会遇到问题，到底哪些命令需要用 <code>cnpm</code>，哪些命令需要用 <code>npm</code> 呢？</p>
</li>
<li><p>VPN 方案有时也不能百分百解决问题，有时有些 VPN 也不稳定，但有个 VPN 很保险就是</p>
</li>
</ul>
<blockquote>
<p>其实 <code>cnpm</code> 的意图并不是简单给我们用来去下载 <code>npm</code> 资源的，它是为 <a href="https://github.com/cnpm/cnpmjs.org">cnpm 服务端（也可以理解成 npm 的私有仓库）</a>服务的。所以你如果简单的把
<code>cnpm</code> 当作 <code>npm</code> 来用会有出现很多问题（<a href="https://github.com/qiu8310/smart-npm/#%E6%8A%8A-cnpm-%E5%BD%93%E4%BD%9C-npm-%E6%9D%A5%E7%94%A8%E6%97%B6%E4%BC%9A%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98">见下</a>）。</p>
</blockquote>
<p><strong>所以，我们就需要一个更智能的 <code>npm</code> 了，可以在我们使用 <code>npm install</code> 时自动从国内的镜像下载，而在我们使用 <code>npm publish</code> 又能发布到官方的 registry 上！</strong></p>
<h3>就让 <code>smart-npm</code> 来为你完成吧！</h3><h2>安装</h2><p><strong>windows 用户安装后，体验没有原生的好，因为每次运行都会创建一个子程序，所以请慎装！</strong> </p>
<p><strong>安装前请先手动备份原 <code>npm</code>，安装后默认的 <code>npm</code> 会被覆盖掉</strong></p>
<pre class="prettyprint source lang-bash"><code># Mac 或者 Linux 用户
ln -s $(npm root -g)/npm/bin/npm-cli.js $(dirname $(which npm))/npm-original  # 将系统的 npm 备份到 npm-original
npm install --global smart-npm --registry=https://registry.npm.taobao.org/

# Window 用户请手动备份 npm.cmd 文件
npm install --global smart-npm --registry=https://registry.npm.taobao.org/</code></pre><p>安装成功后默认会在你的 <code>npm</code> 用户配置文件 <code>~/.npmrc</code> 中添加淘宝的 registry。</p>
<h2>使用</h2><ul>
<li><p>安装后系统的 <code>npm</code> 会被替换了，如果你要使用原生的 <code>npm</code> 命令，可以用 <code>npm-original</code> 代替。</p>
</li>
<li><p>新的 <code>npm</code> 会自动根据你使用的命令切换 registry：当你使用 <code>publish</code>, <code>config</code>, <code>adduser</code>, <code>star</code> 等（<a href="http://qiu8310.github.io/smart-npm/global.html#npm">click here to see more</a>）
命令时，会强制使用官方的 registry <code>https://registry.npmjs.org</code>；当你使用其它命令时，都会使用淘宝的镜像 <code>https://registry.npm.taobao.org/</code>。</p>
<ul>
<li><p>如果要强制使用某个 registry 时，只要在命令后面添加 registry 参数即可，比如，
<code>npm install jquery --registry=https://r.cnpmjs.org</code> 就会使用你指定的 registry 去拉取 <code>jquery</code></p>
</li>
<li><p>如果要强制使用官方的 registry， 只要在命令后面加上 <code>--npm</code> 即可，
比如， <code>npm install jquery --npm</code> 就会使用官方的 registry 去拉取 <code>jquery</code>，（当镜像没有及时更新时，用此会选项很有效）</p>
</li>
<li><p>如果你想修改默认的淘宝镜像或者官方的 registry，可以在你的环境变量中添加这两个参数：
<code>NPM_OFFICIAL_REGISTRY</code>， <code>NPM_MIRROR_REGISTRY</code>，以此来修改默认的官方 registry 和 淘宝镜像 registry。
更多环境变量的配置请<a href="http://qiu8310.github.io/smart-npm/global.html#env">点击这里</a></p>
</li>
</ul>
</li>
</ul>
<h3><code>smart-npm</code> 扩展的几个新命令</h3><ul>
<li><p><strong><code>npm check</code></strong>： 由 <a href="https://github.com/dylang/npm-check">npm-check</a> 提供，和 <code>npm outdated</code> 类似，但提示更人性化，同时它也支持自动更新依赖</p>
</li>
<li><p><strong><code>npm stats {package}</code></strong>： 打开一个网页，可以看到 package 的统计数据，包括被下载的次数、最近更新时间、被依赖的次数及排名等数据</p>
</li>
<li><p><strong><code>npm user {package}</code></strong>： 打开一个网页，跳到用户的 <code>npm</code> 上的个人主页，如果加了参数 <code>-t</code>，则是跳到淘宝镜像的个人主页</p>
</li>
</ul>
<h3>比较有用但很少被用的一些 <code>npm</code> 的命令</h3><ul>
<li><p><strong><code>npm repo {package}</code></strong> ： 用浏览器打开 package 的 github 地址（前提是此 package 的 package.json 文件中有设置 <code>repository</code>）</p>
</li>
<li><p><strong><code>npm home {package}</code></strong> ： 用浏览器打开 package 的首页（前提是此 package 的 package.json 文件中有设置 <code>homepage</code>）</p>
</li>
<li><p><strong><code>npm user {package}</code></strong>：<code>cnpm</code>的功能，用浏览器打开用户在淘宝镜像的主页，如 <code>https://npm.taobao.org/~{user_name}</code></p>
</li>
<li><p><strong><code>npm view {package} versions</code></strong>：查看 package 的所有版本号（只会显示版本号，不显示其它信息）</p>
</li>
<li><p><strong><code>npm outdated</code></strong>：检查当前项目所依赖的 packages 是否有最新的版本可以更新</p>
</li>
</ul>
<h2>卸载</h2><pre class="prettyprint source"><code>npm uninstall --global smart-npm</code></pre><p>卸载会恢复原来的 <code>npm</code></p>
<h2>把 cnpm 当作 npm 来用时会出现的问题</h2><ol>
<li><p><code>publish</code>, <code>adduser</code>, <code>login</code> （<a href="http://qiu8310.github.io/smart-npm/global.html#npm"><em>Click here to see more</em></a>）
等命令无法通过 <code>cnpm</code> 来执行，即运行 <code>cnpm publish</code> 来发布一个版本会失败的</p>
</li>
<li><p>某些命令在 <code>cnpm</code> 和 <code>npm</code> 上表现完全不一样，比如：</p>
<ul>
<li><code>cnpm version</code>：显示当前 <code>cnpm 版本号</code>； 而 <code>npm version</code>：是可以修改当前 package 的版本号的</li>
<li><code>cnpm -g root</code>：会报错； 而 <code>npm -g root</code> 会显示 global 安装的目录</li>
</ul>
</li>
<li><p>有很多 <code>npm</code> 包都集成了 <code>npm install</code>，比如 <a href="http://yeoman.io/">yeoman</a> 的所有 <code>generators</code> ，在最后基本都会
调用 <code>npm install</code>，（<a href="https://github.com/yeoman/generator/blob/v0.18.10/lib/actions/install.js#L147-159"><em>可以看其源码</em></a>）
这种情况下使用 <code>cnpm</code> 完全无效，必须中断操作，然后自己手动运行 <code>cnpm install</code>，或者在运行 <code>yo [generator]</code> 时就指定 <code>--skip-install</code>，
这体验就很不爽了</p>
</li>
<li><p>还有一种情况是，很多和 <code>npm</code> API 相关的 package，都会读取 <code>~/.npmrc</code> 中的 registry，或者使用默认的 registry —— <a href="https://registry.npmjs.org/">https://registry.npmjs.org/</a>，
去查询 npm package 相关的信息，比如下面这些：</p>
<ul>
<li><a href="http://cnpmjs.org/package/npm-latest">npm-latest</a>: 查询某个 package 的最新版本号</li>
<li><a href="http://cnpmjs.org/package/npm-name">npm-name</a>: 查询某个 package name 是否被注册了</li>
<li><a href="https://npm.taobao.org/package/npm-dependents">npm-dependents</a>: 查找某个模块所依赖的其它所有模块</li>
<li>...</li>
</ul>
<p>如果你用的任何一个包或其所依赖的包中用了这些 package，那么在这些包请求网络时也得慢死了！</p>
</li>
</ol>
<h2>调试</h2><h4>调试 npm</h4><p><strong>--loglevel</strong> </p>
<ul>
<li>silent: completely silent. Zero logging output.</li>
<li>win: Just the “npm ok” or “npm not ok” message at the end.</li>
<li>error: When something unexpected and bad happens.</li>
<li>warn: When something odd or potentially dangerous is happening.</li>
<li>info: Helpful information so you can track what’s happening.</li>
<li>verbose: Even more. Perhaps just a wee bit obnoxious, even.</li>
<li>silly: Completely fuckin crazy, man. Dump everything. Whole objects, you name it, whatever.</li>
</ul>
<p><strong>特定 loglevel 的缩写信息</strong></p>
<ul>
<li>s :       [&quot;--loglevel&quot;, &quot;silent&quot;]</li>
<li>d :       [&quot;--loglevel&quot;, &quot;info&quot;]</li>
<li>dd :      [&quot;--loglevel&quot;, &quot;verbose&quot;]</li>
<li>ddd :     [&quot;--loglevel&quot;, &quot;silly&quot;]</li>
<li>silent :  [&quot;--loglevel&quot;, &quot;silent&quot;]</li>
<li>verbose : [&quot;--loglevel&quot;, &quot;verbose&quot;]</li>
<li>quiet:    [&quot;--loglevel&quot;, &quot;warn&quot;]</li>
<li>q:        [&quot;--loglevel&quot;, &quot;warn&quot;]</li>
</ul>
<h2>Todo List</h2><ul>
<li>本地安装也会替代了全局的 <code>npm</code></li>
<li>添加更多有用的组件</li>
<li>修改 <code>stats</code> 命令，把数据显示在命令行上</li>
</ul>
<h2>Reference</h2><ul>
<li><a href="https://npmjs.org/">npm 官网</a></li>
<li><a href="https://docs.npmjs.com/cli/access">所有 npm 支持的子命令</a></li>
<li><a href="https://github.com/cnpm/cnpmjs.org">cnpm server</a></li>
<li><a href="https://github.com/cnpm/cnpm/">cnpm client</a></li>
</ul>
<h1>Release History</h1><p><a href="CHANGELOG.md">Changelog</a></p>
<h2>License</h2><p>Copyright (c) 2015 Zhonglei Qiu. Licensed under the MIT license.</p></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-utils.html">utils</a></li></ul><h3>Global</h3><ul><li><a href="global.html#env">env</a></li><li><a href="global.html#npm-cmds">npm-cmds</a></li><li><a href="global.html#parse-args">parse-args</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta3</a> on Sat Apr 18 2015 23:40:19 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>